#!/usr/bin/env bash
#   This file is part of Mash
#   Copyright (c) 2016-2020, Mash Developers
#
#   Please refer to CONTRIBUTORS.md for a complete list of Copyright
#   holders.
#
#   Mash is free software: you can redistribute it and/or modify
#   it under the terms of the GNU General Public License as published by
#   the Free Software Foundation, either version 3 of the License, or
#   (at your option) any later version.
#
#   Mash is distributed in the hope that it will be useful,
#   but WITHOUT ANY WARRANTY; without even the implied warranty of
#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#   GNU General Public License for more details.
#
#   You should have received a copy of the GNU General Public License
#   along with this program. If not, see <http://www.gnu.org/licenses/>.

# prerm script for mash
#
# see: dh_installdeb(1)

set -e

# summary of how this script can be called:
#        * <postinst> `configure' <most-recently-configured-version>
#        * <old-postinst> `abort-upgrade' <new version>
#        * <conflictor's-postinst> `abort-remove' `in-favour' <package>
#          <new-version>
#        * <postinst> `abort-remove'
#        * <deconfigured's-postinst> `abort-deconfigure' `in-favour'
#          <failed-install-package> <version> `removing'
#          <conflicting-package> <version>
# for details, see https://www.debian.org/doc/debian-policy/ or
# the debian-policy package

function echospaced() {
    printf "\n# %s\n" "${1}"
}

SHAREDIR="/usr/share/mash"
ICONSIZES="16 22 32 48 64 128 256 512"

case "$1" in
    configure)
      echospaced "Uninstalling icons ..."
      for SIZE in ${ICONSIZES}; do
          xdg-icon-resource uninstall --size "${SIZE}" --theme "hicolor" \
              --mode "system" --context "apps" \
              "${SHAREDIR}/icons/hicolor/${SIZE}x${SIZE}/apps/mash.png" \
              collagelabs-mash
      done

      echospaced "Uninstalling desktop and menu files ..."
      xdg-desktop-icon uninstall "${SHAREDIR}/collagelabs-mash.desktop"
      xdg-desktop-menu uninstall --mode "system" "${SHAREDIR}/collagelabs-mash.desktop"
    ;;

    abort-upgrade|abort-remove|abort-deconfigure)
    ;;

    *)
        echo "postinst called with unknown argument \`$1'" >&2
        exit 1
    ;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
